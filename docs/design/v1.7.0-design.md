# CloudPedagogy Course Engine
## v1.7 Design Notes — Authoring Stability & Governance Clarity

**Status:** Draft  
**Target release:** v1.7.0  
**Preceded by:** v1.6.0  
**Audience:** Maintainers, contributors, institutional reviewers  
**Scope:** Authoring workflow, inspection clarity, metadata expressiveness  
**Non-goal:** No architectural rewrite; no agentic automation

---

## 1. Purpose of v1.7

v1.7 consolidates and stabilises the authoring-to-build pipeline that was proven in v1.6 through real-world course migration and large-document ingestion.

The focus of this release is **clarity, durability, and governance confidence** rather than feature expansion. v1.7 exists to make implicit workflows explicit, reduce author ambiguity, and ensure that the Course Engine can be adopted safely in institutional and QA-sensitive contexts.

v1.7 is intentionally conservative. It strengthens foundations rather than extending reach.

---

## 2. Design Positioning

v1.7 sits between two phases of the project:

- **v1.5–v1.6:** Capability expansion and pipeline validation  
- **v1.8+:** Policy, enforcement, and automation

This release acts as a **contract-setting release**: it formalises expectations around authoring, structure, and inspection so that future automation can be introduced without destabilising trust.

---

## 3. Guiding Principles (Reaffirmed)

All v1.7 decisions are constrained by the following principles, inherited unchanged from earlier versions:

1. `course.yml` remains the single source of structural truth
2. Author intent is never inferred or auto-corrected
3. Inspection always precedes enforcement
4. Frameworks are declared, not imposed
5. Human judgement remains the final authority
6. Explainability is prioritised over seamlessness
7. Authoring utilities are separated from runtime tooling

Any proposal that violates these principles is out of scope for v1.7.

---

## 4. What v1.6 Demonstrated

v1.6 validated several critical assumptions:

- External lesson sources can be treated as first-class inputs
- Provenance capture via `manifest.json` is viable and useful
- Fail-fast behaviour for missing or ambiguous inputs builds trust
- Clear separation between:
  - authoring utilities
  - build/compile logic
  - inspection and reporting

However, v1.6 also surfaced friction points:

- Authoring workflows existed but were undocumented
- Splitting large Markdown sources was essential but informal
- Educational numbering conflicted with clean content structure
- Inspection output was correct but not yet reviewer-friendly

v1.7 directly addresses these gaps.

---

## 5. In-Scope Changes for v1.7

### 5.1 Canonical Authoring Pipeline Documentation

**Problem**  
The end-to-end authoring workflow (Word → Pandoc → Markdown → Split → Build) is relied upon but not formally specified.

**v1.7 Response**  
Introduce a normative but non-enforcing authoring contract.

**Deliverable**  
`docs/AUTHORING_PIPELINE.md`

**Contents include:**

- Accepted source formats (Word, Markdown)
- Required heading semantics (H1 = lesson boundary)
- Canonical Pandoc conversion command
- Role and scope of splitting utilities
- Explicit responsibilities of authors vs tooling

This document defines *expectations*, not validation rules.

---

### 5.2 Stabilisation of `split_lessons.py`

**Problem**  
Lesson splitting is essential for real courses but currently ad hoc.

**v1.7 Response**  
Formally recognise `split_lessons.py` as a supported **authoring utility**, not a core engine feature.

**Design decisions:**

- Script lives in `scripts/`
- Clearly marked as non-runtime, pre-build tooling
- Deterministic behaviour only

**Planned enhancements:**

- Multiple split modes:
  - `h1` (default, H1-based splitting)
  - `lesson-numbered` (legacy compatibility)
- Dry-run / inspect mode (no files written)
- Optional clean flag to remove stale outputs
- Stable, predictable filename generation

**Explicit non-goals:**

- No automatic inference of lesson intent
- No integration into `course-engine` CLI

---

### 5.3 Optional Display Labels for Lessons

**Problem**  
Educational contexts require referenceable numbering (e.g. 5.3.A), but embedding this in content creates noise and rigidity.

**v1.7 Response**  
Introduce optional, informational lesson metadata.

**Example:**

```yaml
- id: lesson-07
  title: "Practical Use Cases"
  display_label: "5.3.A"
```

**Rules:**

- Optional
- Informational only
- Not enforced or validated
- Used only at render / presentation layer

This allows:
- Clean Markdown content
- Stable academic referencing
- Thinkific parity without structural coupling

---

### 5.4 Enhanced Inspection Output

**Problem**  
`course-engine inspect` is accurate but insufficient for QA review and governance conversations.

**v1.7 Response**  
Extend inspection with structured, human-readable views.

**Planned inspection modes:**

- `inspect --lessons`
- `inspect --sources`

**Inspection data includes:**

- Lesson order
- Titles and optional display labels
- Source file paths
- Resolution status
- Content hashes

No validation or enforcement is added.

---

### 5.5 Explain-Only Course Resolution Output

**Problem**  
There is no way to programmatically explain a course without building or validating it.

**v1.7 Response**  
Introduce an explain-only command.

```bash
course-engine explain course.yml --json
```

**Output includes:**

- Fully resolved course structure
- Lesson ordering and metadata
- Framework declarations
- Source provenance
- Render-relevant annotations

This output is read-only and non-authoritative. It exists to support dashboards, CI review, and external tooling.

---

### 5.6 Lesson-Level Navigation and TOC Consolidation

**Problem**  
As courses grew longer and more structurally complex, lesson pages accumulated implicit and sometimes redundant navigation affordances (e.g. sidebar lists, inline lesson headings, auto-generated quick links). This risked visual clutter and inconsistent learner orientation, particularly for long-form, reflective lesson content.

**v1.7 Response**  
v1.7 explicitly consolidates lesson-level navigation and table-of-contents (TOC) behaviour, treating lesson pages as *long-form documents* rather than stepwise screens.

**Design decisions (locked for v1.7):**

- Lesson pages use an **in-body Table of Contents**:
  - `toc: true`
  - TOC rendered in the page body (not as a floating side panel)
  - TOC depth limited to section-level headings (`toc-depth: 2`)
- Redundant “Quick links” sections are removed from the lessons index.
- Lesson navigation labels use:
  - `lesson_nav_title` where provided
  - fallback to `lesson_title` otherwise
- Previous / Next lesson navigation is presented as a lightweight, single-line control:
  - Appears **after Lesson details** at the top of the lesson
  - Appears **after Framework alignment** at the end of the lesson
- Navigation is intentionally unstyled beyond spacing and separators:
  - No buttons, icons, or JS enhancements
  - No global “back to top” affordance

**Rationale**  
This approach prioritises reading flow, interpretive depth, and accessibility over interface density. Navigation remains available but secondary to content, aligning with the Course Engine’s governance-first, documentation-style design philosophy.

These decisions are explicitly UI-only and do not affect:
- course schema
- build logic
- validation behaviour
- inspection or explain outputs

---


## 6. Explicitly Out of Scope (Deferred)

The following are **explicitly excluded** from v1.7:

- Agentic workflows
- n8n or workflow automation
- Policy enforcement
- Capability scoring
- Course diffing
- Schema versioning
- Auto-fix or corrective behaviour
- Runtime decision automation

These require a stable authoring contract first.

---

## 7. Backward Compatibility

v1.7 must remain fully compatible with:

- All v1.6 `course.yml` files
- Existing demo courses
- Legacy lesson-numbered Markdown (via splitter modes)

No breaking changes are permitted.

---

## 8. Success Criteria

v1.7 is successful if:

- New authors can follow the pipeline without oral guidance
- Lesson splitting is reproducible and predictable
- Inspection output supports QA and governance review
- Display labels satisfy referencing needs without polluting content
- No new enforcement logic is introduced

---

## 9. Reference Artefacts

- `docs/course-builder-handbook.md`
- `docs/course-builder-design-rationale.md`
- `docs/v1.6-design.md`
- `scripts/split_lessons.py`
- `demo/scenario-planning-environmental-scanning/`

---

## 10. Forward Look (v1.8 Preview)

v1.8 is expected to explore:

- Declarative render profiles
- Course diffing and change provenance
- Policy composition layers
- CI-first explain dashboards
- Agent-assisted authoring (non-decision-making)

These are intentionally excluded from v1.7 to protect stability and trust.

---

*End of v1.7 design document*

